<!DOCTYPE html>
<html>
<head>
  <title>Leaflet Year Filter</title>
  <meta charset="utf-8" />
  <link rel="stylesheet" href="https://unpkg.com/leaflet/dist/leaflet.css" />
  <style>
    #map { height: 600px; }
    #sliderContainer { margin: 10px; }
  </style>
</head>
<body>

<div id="sliderContainer">
  <label for="yearRange">Filter by Year: <span id="yearLabel">2000</span></label>
  <input type="range" id="yearRange" min="2000" max="2025" step="1" value="2000" />
</div>

<div id="map"></div>

<script src="https://unpkg.com/leaflet/dist/leaflet.js"></script>
<script>
  const map = L.map('map').setView([40, -95], 4);

  L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
    attribution: '&copy; OpenStreetMap contributors'
  }).addTo(map);

  let geojsonData;     // will hold the full GeoJSON
  let geojsonLayer;    // Leaflet layer reference

  // Sample GeoJSON points (replace this with your actual data or fetch from file)
  const sampleGeoJSON = {
    "type": "FeatureCollection",
    "features": [
      { "type": "Feature", "properties": { "year": 2000, "name": "Point A" }, "geometry": { "type": "Point", "coordinates": [-100, 40] } },
      { "type": "Feature", "properties": { "year": 2010, "name": "Point B" }, "geometry": { "type": "Point", "coordinates": [-90, 42] } },
      { "type": "Feature", "properties": { "year": 2020, "name": "Point C" }, "geometry": { "type": "Point", "coordinates": [-95, 38] } }
    ]
  };

  geojsonData = sampleGeoJSON; // assign the full dataset

  function updateMap(year) {
    if (geojsonLayer) {
      geojsonLayer.remove(); // remove existing layer
    }

    const filtered = {
      type: "FeatureCollection",
      features: geojsonData.features.filter(f => f.properties.year <= year)
    };

    geojsonLayer = L.geoJSON(filtered, {
      onEachFeature: (feature, layer) => {
        layer.bindPopup(`${feature.properties.name} (${feature.properties.year})`);
      }
    }).addTo(map);
  }

  // Initial load
  updateMap(2000);

  // Event listener for slider
  document.getElementById('yearRange').addEventListener('input', function () {
    const year = parseInt(this.value);
    document.getElementById('yearLabel').textContent = year;
    updateMap(year);
  });
</script>

</body>
</html>
